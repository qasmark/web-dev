const modalBackground=document.querySelector(".modal-background"),modalWindow=document.querySelector(".modal-window"),openModal=document.querySelectorAll(".sign-up-button"),closeModal=document.querySelectorAll(".close-button"),signUpForm=document.getElementById("sign-up-form-id"),userPolicy=document.getElementById("user-policy-checkbox"),modalContent=document.getElementById("modal-content"),messageFormat="<span class='ajax-error'>%message%</span>",errorMessage=messageFormat.replace("%message%","Упс.. Произошла ошибка!");function closeModalWindow(){modalBackground.classList.remove("active"),modalWindow.classList.remove("active-window")}function openModalWindow(){modalBackground.classList.add("active"),modalWindow.classList.add("active-window")}closeModal.forEach(e=>e.addEventListener("click",e=>closeModalWindow())),openModal.forEach(e=>e.addEventListener("click",e=>openModalWindow())),document.addEventListener("keydown",e=>{"Escape"===e.key&&closeModalWindow()}),signUpForm.onsubmit=(async e=>{e.preventDefault();let o=!0;for(let e of signUpForm.children)try{let n=e.value.toString(),a=n.length>0;"username"===e.name&&a&&(a=!/[^a-zA-zа-яА-Я]/.test(n)),"email"===e.name&&a&&(a=/\S+@\S+\.\S+/.test(n)),a?e.classList.remove("invalid-field"):(e.classList.add("invalid-field"),o=!1)}catch(e){}userPolicy.checked&&o&&fetch("./fileHandler.php",{method:"POST",body:new FormData(signUpForm)}).then(e=>e.json().then(e=>{200!==e.status?modalContent.innerHTML=messageFormat.replace("%message%",e.message):closeModalWindow()}).catch(()=>modalContent.innerHTML=errorMessage)).catch(()=>modalContent.innerHTML=errorMessage)});